---
title: "Data manipulation with tidyverse"
subtitle: "Week 2 - Session 4"
date: "July 6th, 20120"
output: 
  html_notebook:
    toc: true
    toc_float: true
    df_print: paged
---

```{r global_options, echo = FALSE, include = FALSE}
options(width = 80)
knitr::opts_chunk$set(
  warning = FALSE, message = FALSE,
  cache = FALSE, tidy = FALSE, size = "small")
```


```{r, warning=FALSE, message=FALSE, eco=FALSE}
library(tidyverse)
```
# Watch the video for Session 4.


Watch the video lecture associated to this Session (find the link on the website).
Once you're done, go through the following exercises.


# Exercise 0: Swirl

Walk through the Getting and Cleaning Data in the swirl package. 

```{r, warning=FALSE, message=FALSE, eval=FALSE}
library(swirl)
swirl::install_course("Getting and Cleaning Data")
swirl()

```

Go through modules 1 through 3.

Once you're done, prepare the following exercises which we will use in our discussion session on Monday, July 6th.


# Execise 1: Data manipulation

## Part 1: `dplyr` verbs

Load in the dataset `movies.csv` at the following http address:

```{r}
url <- "https://raw.githubusercontent.com/Juanets/movie-stats/master/movies.csv"
movies <- read_csv(url)
```


a. Find a subset of the movies produced after 2010. 
Save the subset in 'movies.sub' variable.

b. Keep columns 'name', 'director', 'year', 'country', 'genre', 'budget', 'gross', 'score'
in the 'movies.sub'.

c. Find the profit for each movie in 'movies.sub' as a fraction of its budget.
Convert 'budget' and 'gross' columns million dollar units founded to the first decimal point.
Use `round()` to round numbers.

d. Count the number of movies in 'movies.sub' produced by each genre,
and order them in the descending count order.

e. Now group movies in 'movies.sub' by countries and genre.
Then, count the number of movies in each group and the corresponding 
median fractional profit, the mean and standard deviation of 
the movie score for each group.


## Part 2: Chaining

Using chaining and pipes, for each genre find the three directors the
top mean movie scores received for the movies produced after 2000,
after filtering out the directors with fewer than 5 movies in total.
Hint: Use `top_n()` function to select top n from each group.

Find the movies in your favourite genre by the 5 directors
you just found. These could serve as suggestions for your next movie night!







